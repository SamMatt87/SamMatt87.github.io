<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="/assets/css/style.css?v=82f07e5e57fbe27d3cce2ad6bdf4dc8916d62145">
    <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Aus Rain | SamMatt87.github.io</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Aus Rain" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A place to showcase my personal Data Science projects" />
<meta property="og:description" content="A place to showcase my personal Data Science projects" />
<link rel="canonical" href="http://localhost:4000/SciKitLearn-basics/aus-rain/" />
<meta property="og:url" content="http://localhost:4000/SciKitLearn-basics/aus-rain/" />
<meta property="og:site_name" content="SamMatt87.github.io" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Aus Rain" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"A place to showcase my personal Data Science projects","headline":"Aus Rain","url":"http://localhost:4000/SciKitLearn-basics/aus-rain/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Aus Rain</h1>
          <h2>A place to showcase my personal Data Science projects</h2>
        </header>
        <section id="downloads" class="clearfix">
          
	
        </section>
        <hr>
        <section id="main_content">
          <h2 id="background">Background</h2>
<p>This project uses the weather data for locations across Australia to predict whether or not it will rain there tomorrow. It uses different measurements of variables such as temperature, wind, air pressure, cloud cover and whether or not it rained today and feeds them into a decision tree model to make this prediction. It also outputs a visual representaion of the decision tree.</p>

<h2 id="the-dataset">The Dataset</h2>
<p>The dataset was sourced from kaggle <a href="https://www.kaggle.com/jsphyg/weather-dataset-rattle-package">here</a>. It includes measurements of different weather related variables at the location at different points throughout the day including the minimum and maximum temperatures, the level of rainfall, the level of evaporation, the number of hours of sunshine, the direction and speed of the strongest wind throughout the day, the direction and speed of the wind at 9am and 3pm, the hunmidity at 9am and 3pm, the pressure at 9am and 3pm, the level of cloud cover at 9am and 3pm, the temperature at 9am and 3pm, wheter or not it rained today and whether or not it will rain tomorrow. You can see a sample of the data below.</p>

<p><img src="https://user-images.githubusercontent.com/18587666/136120538-52d2185b-368f-4a4d-aabf-ac7b2382e096.png" alt="image" /></p>

<h2 id="the-process">The Process</h2>
<p>As usual, the first step ws to import some of the packages I would be using. These included numpy for performing calculations on the data, pandas to import and manipulate the data and from sklearn train_test_split to split the data into a train and test set, tree for buiding the decision tree model and accuracy_score for measuring the perfomance of the model.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> 
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</code></pre></div></div>

<p>After importing the data I did some manipulation. This included binary categorisation for any yes or no variables, creating a month variable to represent the month of the year, changing any direction variables to the degrees from North and replacing null values with 0.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'weatherAUS.csv'</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'No'</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'Yes'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Month</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">Date</span><span class="p">).</span><span class="n">month</span><span class="p">.</span><span class="n">values</span>
<span class="n">data</span><span class="p">[</span><span class="s">'Month'</span><span class="p">]</span><span class="o">=</span><span class="n">Month</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">Month</span><span class="p">)</span>
<span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="s">'N'</span><span class="p">,</span><span class="s">'NNE'</span><span class="p">,</span><span class="s">'NE'</span><span class="p">,</span><span class="s">'ENE'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'ESE'</span><span class="p">,</span><span class="s">'SE'</span><span class="p">,</span><span class="s">'SSE'</span><span class="p">,</span><span class="s">'S'</span><span class="p">,</span><span class="s">'SSW'</span><span class="p">,</span><span class="s">'SW'</span><span class="p">,</span><span class="s">'WSW'</span><span class="p">,</span><span class="s">'W'</span><span class="p">,</span><span class="s">'WNW'</span><span class="p">,</span><span class="s">'NW'</span><span class="p">,</span><span class="s">'NNW'</span><span class="p">]</span>
<span class="n">direction_numeric</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">22.5</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mf">67.5</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mf">112.5</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mf">157.5</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mf">202.5</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mf">247.5</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="mf">292.5</span><span class="p">,</span><span class="mi">315</span><span class="p">,</span><span class="mf">337.5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">direction</span><span class="p">)):</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="n">direction</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">direction_numeric</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<p>The next step was to create the X and Y datasets. For the X dataset I removed variables such as the location and date (I kept the month variable I created). The Y data was the target variable ‘Rain Tomorrow’. I then used train test split to create a train and test set for each.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="s">'MinTemp'</span><span class="p">,</span><span class="s">'MaxTemp'</span><span class="p">,</span><span class="s">'Rainfall'</span><span class="p">,</span><span class="s">'Evaporation'</span><span class="p">,</span> <span class="s">'Sunshine'</span><span class="p">,</span><span class="s">'WindGustDir'</span><span class="p">,</span><span class="s">'WindGustSpeed'</span><span class="p">,</span><span class="s">'WindDir9am'</span><span class="p">,</span><span class="s">'WindDir3pm'</span><span class="p">,</span><span class="s">'WindSpeed9am'</span><span class="p">,</span><span class="s">'WindSpeed3pm'</span><span class="p">,</span><span class="s">'Humidity9am'</span><span class="p">,</span><span class="s">'Humidity3pm'</span><span class="p">,</span><span class="s">'Pressure9am'</span><span class="p">,</span><span class="s">'Pressure3pm'</span><span class="p">,</span><span class="s">'Cloud9am'</span><span class="p">,</span><span class="s">'Cloud3pm'</span><span class="p">,</span><span class="s">'Temp9am'</span><span class="p">,</span><span class="s">'Temp3pm'</span><span class="p">,</span><span class="s">'RainToday'</span><span class="p">,</span><span class="s">'Month'</span><span class="p">]]</span>
<span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">'RainTomorrow'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<p>I then built the model with a max depth of 20 and a minimum samples per leaf of 1,000. I fit the model on the train set, ran predictions on the test set and used accuracy score to return an accuracy of around 83%.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">tree</span><span class="p">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_predict</span><span class="o">=</span><span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">y_predict</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</code></pre></div></div>

<p>The final step was to visualise the tree I had created. I created a grphviz export of the model and used pydotplus to create the visualisation. I chose turquoise and orange for the category colours as they contrast each other well. I saved the tree to my local drive and you can see it below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pydotplus</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">pydotplus</span><span class="p">.</span><span class="n">graph_from_dot_data</span><span class="p">(</span><span class="n">dot_data</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">(</span><span class="s">'turquoise'</span><span class="p">,</span> <span class="s">'orange'</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">collections</span><span class="p">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">.</span><span class="n">get_edge_list</span><span class="p">():</span>
    <span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">.</span><span class="n">get_source</span><span class="p">()].</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">edge</span><span class="p">.</span><span class="n">get_destination</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
    <span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">].</span><span class="n">sort</span><span class="p">()</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">dest</span> <span class="o">=</span> <span class="n">graph</span><span class="p">.</span><span class="n">get_node</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="n">i</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dest</span><span class="p">.</span><span class="n">set_fillcolor</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">graph</span><span class="p">.</span><span class="n">write_png</span><span class="p">(</span><span class="s">'tree.png'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/18587666/136124069-3c5fd18f-78df-4294-bf79-0666dfe15fd0.png" alt="tree" /></p>

<h2 id="improvements">Improvements</h2>
<p>Some of the features that I changed to numeric variables like the month and the cardinal direction may have been improved by using one hot encoding instead. I also removed the location variable, dismissing it as not useful. However, some cities on the east coast of Australia receive more rain due to their proximity to both the coast and a mountain range. In the future, it may be useful to add variables like whether a location is on the coast or next to a mountain range to improve accuracy.</p>

<p>You can find the full code for this project online <a href="https://github.com/SamMatt87/Data-science-sample-projects/blob/master/Aus_rain/Aus_rain.py">here</a></p>

        </section>

        <footer>
        
          SamMatt87.github.io is maintained by <a href="https://github.com/SamMatt87">SamMatt87</a><br>
        
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

      </div>
    </div>
  </body>
</html>
